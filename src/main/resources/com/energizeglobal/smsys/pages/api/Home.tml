<html t:type="layout" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd" >
<head>
    <style>
        #main{
            width: 500px;
            margin:0 auto;
            border: 2px solid darkseagreen;
        }
    </style>
    <link rel="stylesheet" href="http://cdn.rawgit.com/jtblin/angular-chart.js/master/dist/angular-chart.css" type="text/css" />
    <script src="http://cdn.rawgit.com/nnnick/Chart.js/master/Chart.min.js" type="text/javascript">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.9/angular.min.js" type="text/javascript">
    </script>
    <script src="http://cdn.rawgit.com/jtblin/angular-chart.js/master/dist/angular-chart.js" type="text/javascript">
    </script>

</head>

<div ng-controller="homeCtrl">

    <h1>{{test}}</h1>

    <div id="main">
        <img src="${getExternalImageLink()}" class="img-circle" width="200" height="200"/>

        <h1>Home</h1>
        <h3>${user.firstName}</h3>
        <h3>${user.lastName}</h3>
        <h3>${user.email}</h3>
        <h3>${user.gender}</h3>
        <h3><t:output format="message:application.main.date.format" value="user.dob"/></h3>



        <a t:type="pagelink" page="api/editprofile" class="btn btn-primary">Edit Profile</a><br/>
        <a t:type="actionlink" t:id="invalidate" class="btn btn-primary">Log Out</a>
    </div>

    <t:if test="isAdmin">
        <div style="margin:0 auto; width: 500px">
            <h2>-- Users --</h2>
            <table border="2px" >
                <tr>
                    <th>Name</th>
                    <th>Surname</th>
                    <th>Email</th>
                    <th>Gender</th>
                    <th>Dob</th>
                </tr>

                <tbody>
                <tr t:type="Loop" t:source="users" t:value="item">
                    <td>${item.firstName}</td>
                    <td>${item.lastName}</td>
                    <td>${item.email}</td>
                    <td>${item.gender}</td>
                    <td><t:output format="message:application.main.date.format" value="item.dob"/></td>
                </tr>
                </tbody>

            </table>
        </div>
    </t:if>

    <div class="eg">
        <a t:type="eventlink" t:event="showThings" t:zone="thingsZone" href="#">Show things, with a delay...</a><br/><br/>

        <t:zone t:id="thingsZone" id="thingsZone" style="width: 140px; min-height: 80px;">
            <div t:type="Loop" t:source="things" t:value="thing">
                ${thing}
            </div>
        </t:zone>

    </div>

    <!--<t:chartComponent t:id="chartComponent" />-->

    <div style="width:500px; height: 400px">
        <canvas id="line" class="chart chart-line" chart-data="data" chart-labels="labels"
                chart-legend="true" chart-series="series" chart-click="onClick"></canvas>
    </div>



</div>

<script type="text/javascript" src="../webjars/angularjs/1.4.0/angular.js"/>
<script type="text/javascript" src="../webjars/jquery/2.1.4/jquery.js"/>

<script type="text/javascript">
    var SMSys = SMSys || {};
</script>

<script type="text/javascript" src="../js/app.js"/>
<script type="text/javascript" src="../js/config/namespace.js"/>
<script type="text/javascript" src="../js/controllers/home.js"/>

</html>